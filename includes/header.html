<nav class="nav navbar navbar-expand-md py-4" id="header">
  <div class="container">

    <!-- Brand -->
    <a class="navbar-brand d-flex align-items-center" href="index.html">
      <img src="../Faenoir/assets/favicon.png" alt="Faenoir Logo" class="mt-n2 mr-2" style="max-height: 40px;">
      Faenoir
    </a>

    <!-- Toggle -->
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#charadexnav" aria-controls="charadexnav" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fa-solid fa-bars"></i>
    </button>

    <!-- Links -->
    <div class="collapse navbar-collapse" id="charadexnav">
      <ul class="navbar-nav ml-auto align-items-center">

        <!-- News / Explore / Catalogue / Help -->
        <!-- Keep your existing nav links here as before -->

        <!-- Login -->
        <li class="nav-item ml-3" id="login-btn">
          <button id="login-btn-main" class="btn btn-primary">Sign In</button>
        </li>

        <!-- Logged-in user info -->
        <li class="nav-item ml-3 d-none" id="user-info">
          <img id="user-avatar" src="" alt="Avatar" class="rounded-circle mr-2" style="height:30px;width:30px;">
          <span id="user-name" class="text-light"></span>
          <button id="logout-btn" class="btn btn-secondary btn-sm ml-2">Sign Out</button>
        </li>

      </ul>
    </div>
  </div>
</nav>

<script>
const LOGIN_KEY = 'faenoir_user';
const AVATARS = {}; // Optionally add avatar URLs for usernames

function checkLogin() {
  const session = JSON.parse(localStorage.getItem(LOGIN_KEY));
  if (!session) return;

  const now = new Date().getTime();
  if (now - session.timestamp > 24 * 60 * 60 * 1000) {
    // Session expired
    localStorage.removeItem(LOGIN_KEY);
    return;
  }

  showUser(session.username);
}

function showUser(username) {
  document.getElementById('login-btn').classList.add('d-none');
  const userInfo = document.getElementById('user-info');
  userInfo.classList.remove('d-none');

  document.getElementById('user-avatar').src = AVATARS[username] || 'default-avatar.png';
  document.getElementById('user-name').textContent = username;
}

function signIn() {
  let username = prompt("Enter your username:");
  if (!username) return alert("Username cannot be empty.");

  let session = JSON.parse(localStorage.getItem(LOGIN_KEY)) || {};
  let savedPasswords = JSON.parse(localStorage.getItem('faenoir_passwords')) || {};

  if (savedPasswords[username]) {
    // Existing user: ask for password
    let pw = prompt("Enter your password:");
    if (pw !== savedPasswords[username]) {
      return alert("Incorrect password.");
    }
  } else {
    // New user: set password
    let pw = prompt("Set a password for your account:");
    if (!pw) return alert("Password cannot be empty.");
    savedPasswords[username] = pw;
    localStorage.setItem('faenoir_passwords', JSON.stringify(savedPasswords));
    alert("Account created successfully!");
  }

  session = { username, timestamp: new Date().getTime() };
  localStorage.setItem(LOGIN_KEY, JSON.stringify(session));
  showUser(username);
}

function logout() {
  localStorage.removeItem(LOGIN_KEY);
  document.getElementById('user-info').classList.add('d-none');
  document.getElementById('login-btn').classList.remove('d-none');
}

// Event listeners
document.getElementById('login-btn-main').addEventListener('click', signIn);
document.getElementById('logout-btn').addEventListener('click', logout);

// Run on page load
checkLogin();
</script>
